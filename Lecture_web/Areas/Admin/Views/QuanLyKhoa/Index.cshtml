@{
Layout = null;
ViewData["Title"] = "Quản lý khoa";

<link rel="stylesheet" href="~/css/khoa-management.css">
<link rel="stylesheet" href="~/css/style.css">
<link rel="stylesheet" href="~/css/admin-dashboard.css">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
}


  <div class="app-container">
    @await Html.PartialAsync("~/Views/Shared/navbar.cshtml")
    <!-- Main Content Area -->
    <main class="main-content">
      <!-- Top Navigation Bar -->
      @await Html.PartialAsync("~/Views/Shared/top_bar.cshtml")
      <!-- Main Content Area -->

      <!-- Khoa Management Content -->
      <div class="container">
        <div class="quick-actions">
          <button class="btn btn-primary" onclick="openModal('faculty')">+ Thêm khoa</button>
        </div>
        <div class="tabs-search-row" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:24px;">
          <div class="tabs">
            <button class="tab-btn active">Khoa</button>
          </div>
          <div class="search-bar" style="width:260px;">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Tìm kiếm khoa...">
          </div>
        </div>
        <!-- Khoa -->
        <div class="tab-content" id="faculties" style="display:block;">
          <table>
            <thead>
              <tr>
                <th>Mã khoa</th>
                <th>Tên khoa</th>
                <th>Số bộ môn</th>
                <th>Trưởng khoa</th>
                <th>Thao tác</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>CNTT</td>
                <td>Khoa Công nghệ thông tin</td>
                <td>5</td>
                <td>PGS.TS Nguyễn Văn A</td>
                <td class="actions">
                  <button class="btn-icon" onclick="openModal('edit-faculty')" title="Sửa">
                    <i class="fas fa-pen-to-square"></i>
                  </button>
                  <button class="btn-icon tooltip" disabled data-tooltip="Không thể xóa khoa đã có học phần" title="Xóa">
                    <i class="fas fa-trash"></i>
                  </button>
                </td>
              </tr>
              <tr>
                <td>QTKD</td>
                <td>Khoa Quản trị kinh doanh</td>
                <td>3</td>
                <td>TS. Lê Văn B</td>
                <td class="actions">
                  <button class="btn-icon" onclick="openModal('edit-faculty')" title="Sửa">
                    <i class="fas fa-pen-to-square"></i>
                  </button>
                  <button class="btn-icon" title="Xóa">
                    <i class="fas fa-trash"></i>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>
  <!-- Modal Thêm/Sửa -->
  <div class="modal" id="modal-faculty">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Thêm khoa</h2>
        <button class="close-modal" onclick="closeModal('faculty')">&times;</button>
      </div>
      <form class="modal-form">
        <div class="form-group">
          <label>Mã khoa</label>
          <input type="text" required>
        </div>
        <div class="form-group">
          <label>Tên khoa</label>
          <input type="text" required>
        </div>
        <div class="form-group">
          <label>Trưởng khoa</label>
          <input type="text" required>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-edit" onclick="closeModal('faculty')">Hủy</button>
          <button type="submit" class="btn btn-primary">Lưu</button>
        </div>
      </form>
    </div>
  </div>
  <!-- Popup chỉnh sửa khoa -->
  <div class="modal" id="modal-edit-faculty">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Chỉnh sửa khoa</h2>
        <button class="close-modal" onclick="closeModal('edit-faculty')">&times;</button>
      </div>
      <form class="modal-form">
        <div class="form-group">
          <label>Mã khoa</label>
          <input type="text" value="CNTT" required>
        </div>
        <div class="form-group">
          <label>Tên khoa</label>
          <input type="text" value="Khoa Công nghệ thông tin" required>
        </div>
        <div class="form-group">
          <label>Trưởng khoa</label>
          <input type="text" value="PGS.TS Nguyễn Văn A" required>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-edit" onclick="closeModal('edit-faculty')">Hủy</button>
          <button type="submit" class="btn btn-primary">Lưu</button>
        </div>
      </form>
    </div>
  </div>


<script>
  function toggleUserMenu() {
    document.querySelector('.user-dropdown').classList.toggle('active');
  }
  // Close dropdown when clicking outside
  document.addEventListener('click', function(event) {
    const userProfile = document.querySelector('.user-profile');
    const dropdown = document.querySelector('.user-dropdown');
    if (!userProfile.contains(event.target)) {
      dropdown.classList.remove('active');
    }
  });

  function logout() {
    if (confirm('Bạn có chắc chắn muốn đăng xuất?')) {
      window.location.href = '/Account/Login';
    }
  }

  function openModal(type) {
    document.getElementById('modal-' + type).classList.add('active');
  }

  function closeModal(type) {
    document.getElementById('modal-' + type).classList.remove('active');
  }
  // Tự động mở popup nếu có ?open=add
  window.addEventListener('DOMContentLoaded', function() {
    const params = new URLSearchParams(window.location.search);
    if (params.get('open') === 'add') {
      openModal('faculty');
    }
  });
  window.addEventListener('DOMContentLoaded', function() {
    const params = new URLSearchParams(window.location.search);
    if (params.get('open') === 'edit') {
      openModal('edit-faculty');
    }
  });
</script>

